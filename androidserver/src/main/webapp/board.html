<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://ququplay.github.io/jquery-mobile-flat-ui-theme/css/jquery.mobile.flatui.css" />
  <script src="http://ququplay.github.io/jquery-mobile-flat-ui-theme/js/jquery.min.js"></script>
  <script src="http://ququplay.github.io/jquery-mobile-flat-ui-theme/js/jquery.mobile-1.3.1.min.js"></script>
  
  <script type="text/javascript">
  var ip = '10.131.158.87:8080/androidserver';
  
  list();
  
  //글 작성 클릭이벤트
  $(document).on('click', '#postbutton', function() {
	  postbutton($('#btitle').val(), $('#bcontent').val());
  });
  
  //글 리스트
  function list() {
    $.ajax('http://' + ip + '/board/list.do', {
      method : 'GET',
      dataType : 'json',
      success : function(result) {
        var rows = result.data;
        var table = $('#boardTable');

        $('.dataRow').remove();

        for ( var i in rows) {
          $('<tr>').attr('class', 'dataRow').html(
              '<th>' + rows[i].bidx + '</th>\n'
            + '<td><a href="post.html"</a>' + rows[i].btitle + '</td>\n'
            + '<td width="43px" nowrap>' + rows[i].onemember.mname + '</td>\n'
            + '<td>' + rows[i].bdate + '</td>\n')
              .appendTo(table);
        }
      },
      error : function(xhr, textStatus, errorThrown) {
        alert('작업을 완료할 수 없습니다.\n' + '잠시 후 다시 시도하세요.\n');
      }
    });
  }
  
  function postbutton(btitle, bcontent) {
	    var params = {
	    		btitle : btitle,
	    		bcontent : bcontent,
	    };
	    
	    $.ajax('http://' + ip + '/board/insert.do', {
	      method: 'POST',
	      data : params,
	      dataType: 'json',
	      success: function(result) {
	    	  alert("글이 등록되었습니다")
	        location.replace("board.html");
	      },
	      error: function(xhr, textStatus, errorThrown) {
	        alert('작업을 완료할 수 없습니다.\n' + 
	            '잠시 후 다시 시도하세요.\n');
	      }
	    });
	  }
</script>

</head>

<body>
<style>
a{ text-decoration: none;}
</style>
<script>
​$("textarea").​​​​​​height(200);
</script>
  <div data-role="page">

<!-- 판넬 -->
<div  data-theme="a" data-role="panel"  data-position="right" id="panel"> 
	
	<input placeholder="제목을 입력해주세요!" type="text" name="btitle" id="btitle">	
	<textarea placeholder="내용을 입력해주세요!" style="height:100px;"rows="20" name="bcontent" id="bcontent"></textarea>
	<div data-role="controlgroup">
		<button type="button" id="postbutton" name="postbutton" data-icon="check" data-theme="c" data-role="button">등록</button>
		<input  data-icon="delete" data-theme="d" data-role="button" type="button" value="취소" onclick="location.href='board.html';"></input>
	</div>
</div>

<!-- 헤더 -->
<div data-role="header">
  <a data-iconpos="notext" data-role="button" data-icon="home" title="Home">Home</a>
  <h1>커뮤니티</h1>
  <a data-iconpos="notext" href="#panel" data-role="button" data-icon="flat-new"></a>
</div>

<!-- 리스트 콘텐트 -->
<div data-role="content" role="main">
	<table>
	
	  <thead>
	    <tr>
	      <th style="width:10%; data-priority="1"></th>
	      <th style="width:80%;"data-priority="persist"></th>
	      <th style="width:20%; data-priority="2"></th>
	      <th style="width:20%; data-priority="4"></th>
	    </tr>
	  </thead>
	  
	  <tbody id="boardTable">
	  <!-- 받아온 값이 세팅되는 자리 --> 
	  </tbody>
	</table>
	
	<!-- 페이징 처리 -->
	<div style="position: absolute; left: 50%; transform: translateX(-50%);"> 
	  <ul class="pagination">
		  <li><a href="#">1</a></li>
		  <li><a href="#">2</a></li>
		  <li><a href="#">3</a></li>
		  <li><a href="#">4</a></li>
		  <li><a href="#">5</a></li>
    </ul>
  </div>
</div>

<!-- 푸터 -->
<div data-role="footer" data-position="fixed">
	<input data-theme="c" type="search" name="search" id="search-basic" value="" />
</div>
</body>
</html>
