<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://ququplay.github.io/jquery-mobile-flat-ui-theme/css/jquery.mobile.flatui.css" />
  <script src="http://ququplay.github.io/jquery-mobile-flat-ui-theme/js/jquery.min.js"></script>
  <script src="http://ququplay.github.io/jquery-mobile-flat-ui-theme/js/jquery.mobile-1.3.1.min.js"></script>
  
  <script type="text/javascript">
  var ip = '10.131.122.79:8080/androidserver';

  //로그인버튼 클릭이벤트
  $(document).on('click', '#login', function() {
    login($('#mname').val(), $('#mpwd').val());
  });
  
  //가입버튼 클릭이벤트
  $(document).on('click', '#joinbutton', function() {
    join($('#mname').val(), $('#mpwd').val(), $('#mloc').val());
  });
  
  //로그인 함수
  function login(mname, mpwd) {
    var params = {
        mname : mname,
        mpwd : mpwd
    };

    $.ajax('http://' + ip + '/member/login.do', {
      method: 'GET',
      data : params,
      dataType: 'json',
      success: function(result) {
        if(result.status == 'success') {
          location.replace("board.html");
        }
        else {
        alert(result.ale);
        }
      },
      error: function(xhr, textStatus, errorThrown) {
        alert('작업을 완료할 수 없습니다.\n' + 
            '잠시 후 다시 시도하세요.\n');
      }
    });
  }
  
//회원가입 함수
  function join(mname, mpwd, mloc) {
    
    var params = {
        mname : mname,
        mpwd : mpwd,
        mloc : mloc,
    };

    $.ajax('http://' + ip + '/member/join.do', {
      method: 'GET',
      data : params,
      dataType: 'json',
      success: function(result) {
        alert(result.ale);
        location.replace("index.html");
      },
      error: function(xhr, textStatus, errorThrown) {
        alert('작업을 완료할 수 없습니다.\n' + 
            '잠시 후 다시 시도하세요.\n');
      }
    });
  }
</script>
  
</head>
<body>
<style>
a{ text-decoration: none;}
</style>

<div data-role="page">

  <!-- 회원가입 판넬 -->
  <div  data-theme="a" data-role="panel"  data-position="right" id="panel">
    <h3 style="color:white;">회원가입</h3>
    <input placeholder="아이디" id="mname" name="mname"/>
    <input type="password" placeholder="비밀번호" id="mpwd" name="mpwd"/>
    <input type="password" placeholder="비밀번호 재확인"/>
    <input placeholder="주소" id="mloc" name="mloc"/>
    <button type="button" id="joinbutton" name="joinbutton" data-icon="check" data-theme="d" data-role="button">확인</button>
  </div>

  <!-- 헤더 -->
  <div data-role="header">
    <a data-iconpos="notext" data-role="button" data-icon="home" title="Home">Home</a>
    <h1 style="font-weight: bold;">로그인</h1>
    <a data-iconpos="notext" href="#panel" data-role="button" data-icon="flat-man"></a>
  </div>

  <!-- 콘텐트 -->
  <div  data-role="content" role="main">
  	<div style="position: absolute; left: 50%; transform: translateX(-50%);">
      <h1 style="font-weight: bold;"> Buffer Overflow </h1>
    </div>
    <br><br><br><br><br><br>
    <input placeholder="아이디" name="mname" id="mname"/>
    <input type="password" placeholder="비밀번호" name="mpwd" id="mpwd"/>
    <div data-role="controlgroup">
      <button type="button" id="login" name="login" data-icon="check" data-theme="c" data-role="button">확인</button>
      <a  data-icon="flat-man" href="#panel"  data-theme="b" data-role="button">회원가입</a>
    </div>
  </div>

</div>
    
<!-- 푸터 -->
<div data-role="footer" data-position="fixed">
	<input data-theme="c" type="search" name="search" id="search-basic" value="" />
</div>
</body>
</html>
